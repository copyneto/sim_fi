sap.ui.define(["sap/m/MessageToast","sap/m/PDFViewer","sap/ui/model/Filter"],function(e,t,r){"use strict";return{onBeforeRendering:function(){this.getView().byId(this.byId("btnCustodiaChequeButton").getId()).setIcon("sap-icon://pdf-attachment");this.getV+
iew().byId(this.byId("btnGerarArquivoButtonButton").getId()).setIcon("sap-icon://attachment-text-file")},getPDFData:function(e,t){let n=[];let a=this.templateBaseExtension.getExtensionAPI();var o=this.getView().getModel();let i=this.templateBaseExtension+
.getExtensionAPI().getSelectedContexts();n.push(new r("Tipo","EQ",t));for(let e of a.getSelectedContexts()){n.push(new r("Bukrs","EQ",e.getObject().Bukrs));n.push(new r("Kunnr","EQ",e.getObject().Kunnr));n.push(new r("Ncheque","EQ",e.getObject().Ncheque)+
)}n=this.removerDuplicatas(n);return new Promise((e,t)=>{o.read("/PDF",{filters:n,success:function(t,r){e(t)},error:function(e){t(e)}})})},onCustodiaCheque:async function(e){var r=this;var n=new t;r.getView().addDependent(n);var a=await r.getPDFData(e,"P+
DF");if(a===""){MessageBox.error("Erro ao gerar PDF");return}let o=a.results[0].stream_data;let i=atob(o);let s=new Uint8Array(i.length);for(var u=0;u<i.length;u++){s[u]=i.charCodeAt(u)}var c=new Blob([s.buffer],{type:"application/pdf"});var d=URL.create+
ObjectURL(c);jQuery.sap.addUrlWhitelist("blob");n.setSource(d);n.setVisible(true);n.setTitle("FormulÃ¡rio de Cheques");n.open()},onGerarArquivo:async function(e){var t=this;var r="";var n=await t.getPDFData(e,"TXT");if(n===""){MessageBox.error("Erro ao ge+
rar o TXT");return}for(let e of n.results){r+=e.txt}t.downloadTxt(r);t.getView().getModel().refresh(true)},downloadTxt:function(e){var t=new Date;var r=t.toISOString().slice(0,19).replace("T"," ");var n="data:application/txt;charset=utf-8,"+encodeURIComp+
onent(e);var a=document.createElement("a");a.href=n;a.download="Arquivo-"+r+".txt";document.body.appendChild(a);a.click();document.body.removeChild(a)},removerDuplicatas:function(e){const t=new Set;return e.filter(e=>{const r=JSON.stringify(e);return!t.h+
as(r)&&t.add(r)})}}});                                                                                                                                                                                                                                         
//# sourceMappingURL=ListReportExt.controller.js.map                                                                                                                                                                                                           